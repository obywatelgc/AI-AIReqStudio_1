:imagesdir: images

= Autodealing

Miniaplikacja Autodealing umożliwia dostęp do systemu zewnętrznego Autodealing służącego do zawierania transakcji fx spot i depozytów po kursie negocjowanym.

Uruchomienie systemu Autodealing dostępne jest w przypadku włączonej usługi *cbp.externalsystem* dla Użytkowników, którzy posiadają zdefiniowany (w aplikacji BackOffice) unikalny identyfikator w Autodealing oraz status weryfikacji Użytkownika w systemie Autodealing jest pozytywny.

W przypadku włączonej usługi *cbp.externalsystem* system udostępnia funkcjonalność, która umożliwia generowanie miniaplikacji dla wielu systemów zewnętrznych na bazie miniaplikacji Autodealing. Podczas generowania miniaplikacji można wskazać dedykowane nazwy oraz grafiki dla miniaplikacji.

Podstawowe pojęcia związane z systemem zewnętrznym Autodealing:

[cols="5,15",options="header",]
|===========================================================================================================================================================================================================================================
|*Pojęcie* |*Opis*
|HTTPS |Szyfrowana wersja protokołu http.
|userId |Unikalny identyfikator Użytkownika w systemie Autodealing - userId składa się ze znaków z zakresu: azAZ09_ . Maksymalna liczba znaków to 50. Minimalna liczba znaków to 3. Identyfikator (userId) przypisywany jest do Użytkownika.
|tokenSSO |Token, na podstawie którego następuje uwierzytelnienie. Jest to generowany określony zestaw znaków.
|===========================================================================================================================================================================================================================================

== Autodealing

System Asseco EBP zapewnia Użytkownikowi dostęp do systemu zewnętrznego Autodealing z dwóch głównych poziomów:

* widżetu *Autodealing* (wyświetlanego na pulpicie o ile Użytkownik nie usunął go z pulpitu),

image::Autodealing/image1.png[image,width=276,height=180]

* menu bocznego po wybraniu opcji _Autodealing_.

image::Autodealing/image2.png[image,width=155,height=427]

Po kliknięciu w odnośnik [URUCHOM AUTODEALING] na widżecie *Autodealing* lub poprzez wybór opcji z bocznego menu _Autodealing_ zostanie wyświetlona formatka z listą Użytkowników umożliwiająca skorzystanie z dedykowanej oferty stworzonej na Platformie Autodealing. Dodatkowo dostępny jest przycisk [URUCHOM] umożliwiający uruchomienie systemu zewnętrznego Autodealing.

image::Autodealing/image3.png[image,width=604,height=85]

W przypadku, gdy Użytkownik reprezentuje więcej niż jednego klienta, na formularzu Autodealing prezentowana jest lista klientów do których zalogowany Użytkownik jest uprawniony wraz z przyciskiem [URUCHOM], który jest dostępny odrębnie dla każdego klienta. W takiej sytuacji Użytkownik ma możliwość uruchomienia systemu zewnętrznego Autodealing w kontekście wskazanego klienta.

image::Autodealing/image4.png[image,width=603,height=115]

Uruchomienie systemu zewnętrznego Autodealing, następuje w osobnym oknie przeglądarki bez potrzeby jawnego (dane nie są wprowadzane przez Użytkownika) uwierzytelnienia Użytkownika przez system Autodealing, przy założeniu, że Użytkownik jest zalogowany do systemu Asseco EBP.

Do poprawnego połączenia z systemem Autodealing wymagana jest parametryzacja w systemie BackOffice (zgodnie z dokumentacją Użytkownika BackOffice).

Generowanie linku do systemu Autodealing odbywa się, gdy Użytkownik spełni następujące warunki:

* ma przypisany identyfikator systemu Autodealing (userId),
* status weryfikacji Użytkownika w systemie Autodealing jest pozytywny,
* w parametrach systemu Asseco BackOffice zdefiniowana jest nazwa systemu Autodealing oraz poprawny URL do systemu Autodealing,
* zostanie poprawnie wygenerowany tokenSSO.

Po autentykacji Użytkownika w systemie Autodealing nie będzie bieżącej kontroli sesji w systemie Asseco EBP, czyli możliwe będzie korzystanie przez klienta z systemu Autodealing, niezależnie od zamknięcia systemu Asseco EBP lub wygaśnięcia sesji systemu Asseco EBP, aż do czasu wygaśnięcia ważności tokenaSSO.

W przypadku, gdy Użytkownik nie posiada dostępu do usługi w Autodealing (w systemie Asseco BackOffice dla Użytkownika nie ustawiono identyfikatora lub status weryfikacji jest nieprawidłowy) po wyborze opcji zostanie zaprezentowany komunikat jak na poniższym ekranie.

image::Autodealing/image5.png[image,width=540,height=329]

W sytuacji, gdy platforma Autodealing jest czasowo niedostępna, po wyborze opcji [URUCHOM], zostanie zaprezentowany Użytkownikowi następujący komunikat „_Usługa chwilowo niedostępna"_.

image::Autodealing/image6.png[image,width=538,height=312]

Dostępne opcje:

* [OK] – po naciśnięciu następuje powrót do głównego menu.

== Multidealing

W celu udostępnienia funkcjonalności obsługi wielu systemów zewnętrznych, należy włączyć usługę *cbp.externalsystem*.

Do poprawnego połączenia z wieloma systemami zewnętrznymi wymagane jest ustawienie następujących parametrów w tabelach EXTERNAL_SYSTEM oraz EXTERNAL_SYSTEM_USER na bazie systemu Asseco EBP.

W tabeli EXTERNAL_SYSTEM należy ustawić następujące parametry (wszystkie obowiązkowe):

* *SYMBOL* – symbol systemu zewnętrznego,
* *NAME* – nazwa systemu zewnętrznego,
* *URL* – bazowy URL systemu zewnętrznego, na bazie którego będzie zbudowany url z żądaniem otwarcia aplikacji zewnętrznej,
* *VALIDATE_URL* – URL usługi walidującej Użytkownika systemu zewnętrznego.

Podczas przypisywania identyfikatora Użytkownikowi w systemie Asseco BackOffice w tabeli EXTERNAL_SYSTEM_USER zapisywane są następujące dane:

* USER_ID – identyfikator Użytkownika Asseco EBP,
* CLIENT_ID – identyfikator klienta (ID_KL_DEF) Asseco EBP,
* EXTERNAL_SYSTEM_USER_ID – identyfikator Użytkownika w systemie zewnętrznym,
* EXTERNAL_SYSTEM_SYMBOL – symbol systemu zewnętrznego, pole powinno mieć swój odpowiednik w _EXTERNAL_SYSTEM.SYMBOL_,
* STATUS – status w systemie zewnętrznym.

Po autentykacji Użytkownika w systemie zewnętrznym nie będzie bieżącej kontroli sesji w systemie Asseco EBP, czyli możliwe będzie korzystanie przez klienta z aplikacji zewnętrznej niezależnie od zamknięcia aplikacji Asseco EBP lub wygaśnięcia sesji aplikacji Asseco EBP, aż do czasu wygaśnięcia ważności tokenaSSO.

Każda miniaplikacja Autodealing dostępna jest w menu bocznym systemu oraz na pulpicie jako odrębna pozycja.

image::Autodealing/image7.png[image,width=157,height=498]

image::Autodealing/image8.png[image,width=603,height=136]

Funkcjonalność uruchamiania miniaplikacji Autodealing została opisana w rozdziale Autodealing.
